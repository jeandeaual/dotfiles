# Configuration for Alacritty, the GPU enhanced terminal emulator.

{{- $shell := env "SHELL" | default "/bin/sh" -}}
{{- $tmux := "tmux" -}}
{{- if and (eq .chezmoi.os "darwin") (eq .chezmoi.arch "arm64") -}}
{{- /* Programs install via Homebrew on Apple Silicon are not on the PATH by default */ -}}
{{-   $tmux = "/opt/homebrew/bin/tmux" -}}
{{- end -}}
{{- if regexMatch "elvish$" $shell }}

# Start tmux when launching alacritty
shell:
  program: {{ $shell | quote }}
  args:
    - -c
    - or ({{ $tmux }} attach) ({{ $tmux }})
{{- else if regexMatch "(ba|z|da|a|fi)sh$" $shell }}

# Start tmux when launching alacritty
shell:
  program: {{ $shell | quote }}
  args:
    - -l
    - -c
    - {{ $tmux }} attach || {{ $tmux }}
{{- end }}

window:
  # Spread additional padding evenly around the terminal content.
  dynamic_padding: true

  # Background opacity
  #
  # Window opacity as a floating point number from `0.0` to `1.0`.
  # The value `0.0` is completely transparent and `1.0` is opaque.
  opacity: 1.0

  # Window decorations
  #
  # Values for `decorations`:
  #     - full: Borders and title bar
  #     - none: Neither borders nor title bar
  #
  # Values for `decorations` (macOS only):
  #     - transparent: Title bar, transparent background and title bar buttons
  #     - buttonless: Title bar, transparent background, but no title bar buttons
  decorations: full

{{- if eq .chezmoi.os "darwin" }}
  # Startup Mode (changes require restart)
  #
  # Values for `startup_mode`:
  #   - Windowed
  #   - Maximized
  #   - Fullscreen
  #
  # Values for `startup_mode` (macOS only):
  #   - SimpleFullscreen
  startup_mode: Fullscreen
{{- end }}


# Sample Font configuration for font: Monoid.
# Feel free to use different font configuration family & face for each sections
font:
  # Normal font face - Also used to draw glyphs on tmux & VIM
  normal:
{{- if eq .chezmoi.os "windows" }}
    family: FiraCode NF
{{- else }}
    family: FiraCode Nerd Font
    style: Retina
{{- end }}

  bold:
{{- if eq .chezmoi.os "windows" }}
    family: FiraCode NF
{{- else }}
    family: FiraCode Nerd Font
{{- end }}
    style: Bold

#   italic:
#     family: FiraCode Nerd Font
#     style: Italic

#   bold_italic:
#     family: FiraCode Nerd Font
#     style: Bold Italic

  # Point size
  size: 12.0

# If `true`, bold text is drawn using the bright color variants.
draw_bold_text_with_bright_colors: true

scrolling:
  # Maximum number of lines in the scrollback buffer.
  # Specifying '0' will disable scrolling.
  history: 10000

  # Number of lines the viewport will move for every line scrolled when
  # scrollback is enabled (history > 0).
  multiplier: 1

  # Scroll to the bottom when new text is written to the terminal.
  auto_scroll: false

# Colors (Tomorrow-Night with black background)
colors:
  # Default colors
  primary:
    background: "#000000"
    foreground: "#c5c8c6"

  # Colors the cursor will use if `custom_cursor_colors` is true
  cursor:
    text: "#000000"
    cursor: "#c5c8c6"

  # Normal colors
  normal:
    black:   "#000000"
    red:     "#cc6666"
    green:   "#b5bd68"
    yellow:  "#e6c547"
    blue:    "#81a2be"
    magenta: "#b294bb"
    cyan:    "#70c0ba"
    white:   "#373b41"

  # Bright colors
  bright:
    black:   "#666666"
    red:     "#ff3334"
    green:   "#9ec400"
    yellow:  "#f0c674"
    blue:    "#81a2be"
    magenta: "#b77ee0"
    cyan:    "#54ced6"
    white:   "#282a2e"

selection:
  # When set to `true`, selected text will be copied to the primary clipboard.
  save_to_clipboard: true

cursor:
  # Cursor style
  style:
    # Cursor shape
    #
    # Values for `shape`:
    #   - â–‡ Block
    #   - _ Underline
    #   - | Beam
    shape: Block

    # Cursor blinking state
    #
    # Values for `blinking`:
    #   - Never: Prevent the cursor from ever blinking
    #   - Off: Disable blinking by default
    #   - On: Enable blinking by default
    #   - Always: Force the cursor to always blink
    blinking: Off

# Live config reload (changes require restart)
live_config_reload: true

# Use xxd -psd to find the chars to send
key_bindings:
{{- if eq .chezmoi.os "darwin" }}
  # Use Command + [ to go to previous tmux window
  - { key: LBracket, mods: Command, chars: "\x02\x70" }
  # Use Command + ] to go to previous tmux window
  - { key: RBracket, mods: Command, chars: "\x02\x6e" }
{{- end }}
  # Spawn a new instance of Alacritty in the current working directory by pressing Ctrl+Shift+Enter
  - { key: Return,   mods: Control|Shift, action: SpawnNewInstance }
